import{_ as o}from"./Modal.b02e0653.js";import{_ as e}from"./Button.9e794eb8.js";import{d as t,r as s,o as r,g as a,f as n,p as i,s as d,w as c,u as l,t as u,D as m,n as f,e as p,i as h,F as w,x as g}from"./vendor.a36873b3.js";import{_ as y}from"./DialogModal.1a71a52e.js";import{_ as b}from"./Input.3370192f.js";import{_ as C}from"./InputError.78d398ee.js";import{_ as v}from"./SecondaryButton.ce63d693.js";import{_ as x}from"./DangerButton.f0e7e8c9.js";import"./SectionTitle.7e28176a.js";const _=t({emits:["confirmed"],props:{title:{default:"Confirm Password"},content:{default:"For your security, please confirm your password to continue."},button:{default:"Confirm"}},components:{JetButton:e,JetDialogModal:y,JetInput:b,JetInputError:C,JetSecondaryButton:v},data:()=>({confirmingPassword:!1,form:{password:"",error:""}}),methods:{startConfirmingPassword(){axios.get(route("password.confirmation")).then((o=>{o.data.confirmed?this.$emit("confirmed"):(this.confirmingPassword=!0,setTimeout((()=>this.$refs.password.focus()),250))}))},confirmPassword(){this.form.processing=!0,axios.post(route("password.confirm"),{password:this.form.password}).then((()=>{this.form.processing=!1,this.closeModal(),this.$nextTick((()=>this.$emit("confirmed")))})).catch((o=>{this.form.processing=!1,this.form.error=o.response.data.errors.password[0],this.$refs.password.focus()}))},closeModal(){this.confirmingPassword=!1,this.form.password="",this.form.error=""}}}),j={class:"mt-4"},k=l(" Cancel ");_.render=function(o,e,t,p,h,w){const g=s("jet-input"),y=s("jet-input-error"),b=s("jet-secondary-button"),C=s("jet-button"),v=s("jet-dialog-modal");return r(),a("span",null,[n("span",{onClick:e[0]||(e[0]=(...e)=>o.startConfirmingPassword&&o.startConfirmingPassword(...e))},[i(o.$slots,"default")]),d(v,{show:o.confirmingPassword,onClose:o.closeModal},{title:c((()=>[l(u(o.title),1)])),content:c((()=>[l(u(o.content)+" ",1),n("div",j,[d(g,{type:"password",class:"mt-1 block w-3/4",placeholder:"Password",ref:"password",modelValue:o.form.password,"onUpdate:modelValue":e[1]||(e[1]=e=>o.form.password=e),onKeyup:m(o.confirmPassword,["enter"])},null,8,["modelValue","onKeyup"]),d(y,{message:o.form.error,class:"mt-2"},null,8,["message"])])])),footer:c((()=>[d(b,{onClick:o.closeModal},{default:c((()=>[k])),_:1},8,["onClick"]),d(C,{class:f(["ml-2",{"opacity-25":o.form.processing}]),onClick:o.confirmPassword,disabled:o.form.processing},{default:c((()=>[l(u(o.button),1)])),_:1},8,["onClick","class","disabled"])])),_:1},8,["show","onClose"])])};const P=t({components:{JetActionSection:o,JetButton:e,JetConfirmsPassword:_,JetDangerButton:x,JetSecondaryButton:v},data:()=>({enabling:!1,disabling:!1,qrCode:null,recoveryCodes:[]}),methods:{enableTwoFactorAuthentication(){this.enabling=!0,this.$inertia.post("/user/two-factor-authentication",{},{preserveScroll:!0,onSuccess:()=>Promise.all([this.showQrCode(),this.showRecoveryCodes()]),onFinish:()=>this.enabling=!1})},showQrCode(){return axios.get("/user/two-factor-qr-code").then((o=>{this.qrCode=o.data.svg}))},showRecoveryCodes(){return axios.get("/user/two-factor-recovery-codes").then((o=>{this.recoveryCodes=o.data}))},regenerateRecoveryCodes(){axios.post("/user/two-factor-recovery-codes").then((o=>{this.showRecoveryCodes()}))},disableTwoFactorAuthentication(){this.disabling=!0,this.$inertia.delete("/user/two-factor-authentication",{preserveScroll:!0,onSuccess:()=>this.disabling=!1})}},computed:{twoFactorEnabled(){return!this.enabling&&this.$page.props.user.two_factor_enabled}}}),F=l(" Two Factor Authentication "),S=l(" Add additional security to your account using two factor authentication. "),T={key:0,class:"text-lg font-medium text-gray-900"},J={key:1,class:"text-lg font-medium text-gray-900"},R=n("div",{class:"mt-3 max-w-xl text-sm text-gray-600"},[n("p",null," When two factor authentication is enabled, you will be prompted for a secure, random token during authentication. You may retrieve this token from your phone's Google Authenticator application. ")],-1),M={key:2},$={key:0},A=n("div",{class:"mt-4 max-w-xl text-sm text-gray-600"},[n("p",{class:"font-semibold"}," Two factor authentication is now enabled. Scan the following QR code using your phone's authenticator application. ")],-1),B=["innerHTML"],E={key:1},D=n("div",{class:"mt-4 max-w-xl text-sm text-gray-600"},[n("p",{class:"font-semibold"}," Store these recovery codes in a secure password manager. They can be used to recover access to your account if your two factor authentication device is lost. ")],-1),q={class:"\n                            grid\n                            gap-1\n                            max-w-xl\n                            mt-4\n                            px-4\n                            py-4\n                            font-mono\n                            text-sm\n                            bg-gray-100\n                            rounded-lg\n                        "},I={class:"mt-5"},Q={key:0},V=l(" Enable "),Y={key:1},H=l(" Regenerate Recovery Codes "),K=l(" Show Recovery Codes "),L=l(" Disable ");P.render=function(o,e,t,i,l,m){const y=s("jet-button"),b=s("jet-confirms-password"),C=s("jet-secondary-button"),v=s("jet-danger-button"),x=s("jet-action-section");return r(),p(x,null,{title:c((()=>[F])),description:c((()=>[S])),content:c((()=>[o.twoFactorEnabled?(r(),a("h3",T," You have enabled two factor authentication. ")):(r(),a("h3",J," You have not enabled two factor authentication. ")),R,o.twoFactorEnabled?(r(),a("div",M,[o.qrCode?(r(),a("div",$,[A,n("div",{class:"mt-4",innerHTML:o.qrCode},null,8,B)])):h("",!0),o.recoveryCodes.length>0?(r(),a("div",E,[D,n("div",q,[(r(!0),a(w,null,g(o.recoveryCodes,(o=>(r(),a("div",{key:o},u(o),1)))),128))])])):h("",!0)])):h("",!0),n("div",I,[o.twoFactorEnabled?(r(),a("div",Y,[d(b,{onConfirmed:o.regenerateRecoveryCodes},{default:c((()=>[o.recoveryCodes.length>0?(r(),p(C,{key:0,class:"mr-3"},{default:c((()=>[H])),_:1})):h("",!0)])),_:1},8,["onConfirmed"]),d(b,{onConfirmed:o.showRecoveryCodes},{default:c((()=>[0===o.recoveryCodes.length?(r(),p(C,{key:0,class:"mr-3"},{default:c((()=>[K])),_:1})):h("",!0)])),_:1},8,["onConfirmed"]),d(b,{onConfirmed:o.disableTwoFactorAuthentication},{default:c((()=>[d(v,{class:f({"opacity-25":o.disabling}),disabled:o.disabling},{default:c((()=>[L])),_:1},8,["class","disabled"])])),_:1},8,["onConfirmed"])])):(r(),a("div",Q,[d(b,{onConfirmed:o.enableTwoFactorAuthentication},{default:c((()=>[d(y,{type:"button",class:f({"opacity-25":o.enabling}),disabled:o.enabling},{default:c((()=>[V])),_:1},8,["class","disabled"])])),_:1},8,["onConfirmed"])]))])])),_:1})};export{P as default};
